"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[186],{51042:function(Y,O,e){var d=e(1413),p=e(67294),C=e(42110),s=e(91146),_=function(i,M){return p.createElement(s.Z,(0,d.Z)((0,d.Z)({},i),{},{ref:M,icon:C.Z}))},n=p.forwardRef(_);O.Z=n},88484:function(Y,O,e){e.d(O,{Z:function(){return i}});var d=e(1413),p=e(67294),C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},s=C,_=e(91146),n=function(v,S){return p.createElement(_.Z,(0,d.Z)((0,d.Z)({},v),{},{ref:S,icon:s}))},x=p.forwardRef(n),i=x},64317:function(Y,O,e){var d=e(1413),p=e(91),C=e(22270),s=e(67294),_=e(66758),n=e(68256),x=e(85893),i=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],M=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],v=function(c,U){var F=c.fieldProps,I=c.children,j=c.params,B=c.proFieldProps,z=c.mode,$=c.valueEnum,G=c.request,V=c.showSearch,g=c.options,f=(0,p.Z)(c,i),te=(0,s.useContext)(_.Z);return(0,x.jsx)(n.Z,(0,d.Z)((0,d.Z)({valueEnum:(0,C.h)($),request:G,params:j,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,d.Z)({options:g,mode:z,showSearch:V,getPopupContainer:te.getPopupContainer},F),ref:U,proFieldProps:B},f),{},{children:I}))},S=s.forwardRef(function(h,c){var U=h.fieldProps,F=h.children,I=h.params,j=h.proFieldProps,B=h.mode,z=h.valueEnum,$=h.request,G=h.options,V=(0,p.Z)(h,M),g=(0,d.Z)({options:G,mode:B||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},U),f=(0,s.useContext)(_.Z);return(0,x.jsx)(n.Z,(0,d.Z)((0,d.Z)({valueEnum:(0,C.h)(z),request:$,params:I,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,d.Z)({getPopupContainer:f.getPopupContainer},g),ref:c,proFieldProps:j},V),{},{children:F}))}),K=s.forwardRef(v),re=S,b=K;b.SearchSelect=re,b.displayName="ProFormComponent",O.Z=b},58547:function(Y,O,e){e.d(O,{h:function(){return p}});var d=e(67294),p=function(_){return Array.isArray(_)?_:_&&_.fileList},C=function(_){return new Promise(function(n,x){var i=new FileReader;i.readAsDataURL(_.file.originFileObj),i.onload=function(){var M=i.result;n(M)},i.onerror=function(M){return x(M)}})}},11817:function(Y,O,e){e.r(O);var d=e(97857),p=e.n(d),C=e(5574),s=e.n(C),_=e(15009),n=e.n(_),x=e(99289),i=e.n(x),M=e(6110),v=e(34994),S=e(2236),K=e(38345),re=e(5966),b=e(90672),h=e(5155),c=e(64317),U=e(2453),F=e(8232),I=e(71230),j=e(15746),B=e(83622),z=e(95715),$=e(66476),G=e(51042),V=e(88484),g=e(67294),f=e(76772),te=e(58547),t=e(85893),de=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return new Promise(function(a){setTimeout(function(){a(!0)},R)})},_e={image_url:"",title:"",description:"",tutors:"",users:""},ve=function(){var oe=i()(n()().mark(function R(a,k){var w,H,N;return n()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return console.log("onFinishHandlerForm"),console.log("Received values of form: ",a),m.prev=2,N={image_url:k,title:a==null?void 0:a.title,description:a==null?void 0:a.description,author_id:1,tutors:(a==null||(w=a.tutors)===null||w===void 0?void 0:w.map(function(E){return E==null?void 0:E.tutor}))||[],users:(a==null||(H=a.users)===null||H===void 0?void 0:H.map(function(E){return E==null?void 0:E.user}))||[]},m.next=6,(0,f.request)("/api/categories/"+(a==null?void 0:a.category_id),{method:"PUT",data:N}).then(function(){var E=i()(n()().mark(function J(T){var Q,X;return n()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:(T==null||(Q=T.data)===null||Q===void 0?void 0:Q.id)>0&&(U.ZP.success("Submitted successfully"),f.history.push("/admin-app/categories/edit/"+(T==null||(X=T.data)===null||X===void 0?void 0:X.id)));case 1:case"end":return D.stop()}},J)}));return function(J){return E.apply(this,arguments)}}()).catch(function(E){console.log(E)});case 6:return m.abrupt("return",m.sent);case 9:m.prev=9,m.t0=m.catch(2),console.log("api_response - error"),console.log(m.t0);case 13:return m.abrupt("return",!0);case 14:case"end":return m.stop()}},R,null,[[2,9]])}));return function(a,k){return oe.apply(this,arguments)}}(),he=function(){var R=(0,f.useParams)(),a=F.Z.useForm(),k=s()(a,1),w=k[0],H=(0,g.useState)(0),N=s()(H,2),ne=N[0],m=N[1],E=(0,g.useState)(""),J=s()(E,2),T=J[0],Q=J[1],X=(0,g.useState)(T),ae=s()(X,2),D=ae[0],ce=ae[1],Ee=(0,g.useState)([]),me=s()(Ee,2),Pe=me[0],ge=me[1],fe=(0,g.useState)([]),pe=s()(fe,2),De=pe[0],Oe=pe[1];return(0,g.useEffect)(function(){m(R.id)},[]),(0,g.useEffect)(function(){return(0,f.request)("/api/users",{params:{role:"tutor",page:1,per_page:1e3}}).then(function(P){var r=P.data.data.map(function(o,y){return{value:o==null?void 0:o.id,label:o==null?void 0:o.name}});return ge(r),r})},[]),(0,g.useEffect)(function(){return(0,f.request)("/api/users",{params:{role:"user",page:1,per_page:1e3}}).then(function(P){var r=P.data.data.map(function(o,y){return{value:o==null?void 0:o.id,label:o==null?void 0:o.name}});return Oe(r),r})},[]),(0,t.jsxs)(M._z,{children:[(0,t.jsxs)(I.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,t.jsx)(j.Z,{flex:"auto"}),(0,t.jsx)(j.Z,{flex:"100px",children:(0,t.jsxs)(B.ZP,{type:"primary",onClick:function(){f.history.push("/admin-app/categories/new")},style:{marginBlockEnd:15},children:[(0,t.jsx)(G.Z,{})," New"]},"new")})]}),(0,t.jsxs)(v.A,{layout:"vertical",grid:!0,initialValues:_e,form:w,params:{category_id:ne},request:i()(n()().mark(function P(){var r,o=arguments;return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(r=o.length>0&&o[0]!==void 0?o[0]:{},console.log("proform-params"),console.log(r),(r==null?void 0:r.category_id)!=0){u.next=5;break}return u.abrupt("return");case 5:return u.next=7,de(2e3);case 7:return u.next=9,(0,f.request)("/api/categories/"+(r==null?void 0:r.category_id),{method:"GET"}).then(function(){var q=i()(n()().mark(function W(l){var le,se,ie,ue,L,Z;return n()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return console.log("api_response"),console.log(l),Q(l==null||(le=l.data)===null||le===void 0?void 0:le.image_url),ee.abrupt("return",p()(p()({},_e),{},{image_url:l==null||(se=l.data)===null||se===void 0?void 0:se.image_url,title:l==null||(ie=l.data)===null||ie===void 0?void 0:ie.title,description:l==null||(ue=l.data)===null||ue===void 0?void 0:ue.description,tutors:(l==null||(L=l.data)===null||L===void 0||(L=L.tutors)===null||L===void 0?void 0:L.map(function(A){return{tutor:A==null?void 0:A.id}}))||[],users:(l==null||(Z=l.data)===null||Z===void 0||(Z=Z.users)===null||Z===void 0?void 0:Z.map(function(A){return{user:A==null?void 0:A.id}}))||[]}));case 4:case"end":return ee.stop()}},W)}));return function(W){return q.apply(this,arguments)}}()).catch(function(q){console.log(q)});case 9:return u.abrupt("return",u.sent);case 10:case"end":return u.stop()}},P)})),onFinish:function(){var P=i()(n()().mark(function r(o){return n()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,de(2e3);case 2:return o.category_id=ne,o.image_url=D,console.log("imageUrl"),console.log(D),console.log("Final payload values:",o),u.next=9,ve(o,D);case 9:case"end":return u.stop()}},r)}));return function(r){return P.apply(this,arguments)}}(),submitter:{render:function(r,o){return(0,t.jsx)(S.S,{children:o})}},children:[(0,t.jsx)(K.Z,{title:"Category Details",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},onCollapse:function(r){return console.log(r)},children:(0,t.jsxs)(I.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,t.jsx)(j.Z,{span:6,children:(0,t.jsxs)(v.A.Group,{size:24,children:[(0,t.jsx)(j.Z,{span:24,children:(0,t.jsx)(z.Z,{width:"100%",height:200,src:D,fallback:D!==""||D===null?D:"http://mairaj.project.localhost.com/images/default/placeholder.jpg"})}),(0,t.jsx)(j.Z,{span:24,style:{textAlign:"center"},children:(0,t.jsx)(v.A.Item,{name:"image_url",getValueFromEvent:te.h,children:(0,t.jsx)($.Z,{name:"file",onChange:function(r){if(console.log("file - onChange - info"),console.log(r),r.file.status!=="uploading"){if(r.file.status=="removed"&&ce(""),r.file.status==="done"){var o;ce(r==null||(o=r.file)===null||o===void 0||(o=o.response)===null||o===void 0?void 0:o.url)}r.file.status==="error"&&U.ZP.error("".concat(r.file.name," file upload failed."))}},maxCount:1,action:"/api/file-manager/upload",data:{directory:"categories"},onRemove:function(r){console.log("file is removed"),console.log(r),(0,f.request)("/api/file-manager/delete",{method:"DELETE",data:{filename:r==null?void 0:r.name,directory:"categories"}}).then(function(){var o=i()(n()().mark(function y(u){return n()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:console.log("api_response"),console.log(u);case 2:case"end":return W.stop()}},y)}));return function(y){return o.apply(this,arguments)}}())},children:(0,t.jsx)(B.ZP,{type:"primary",icon:(0,t.jsx)(V.Z,{}),style:{margin:"10px 0px 0px 0px"},onClick:function(r){},children:"Change Image"})})})})]})}),(0,t.jsxs)(j.Z,{span:18,children:[(0,t.jsx)(v.A.Group,{size:24,children:(0,t.jsx)(re.Z,{name:"title",label:"Title",placeholder:"Type Category Title",colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,t.jsx)(v.A.Group,{size:24,children:(0,t.jsx)(b.Z,{name:"description",label:"Description",fieldProps:{rows:6},placeholder:"Share a little description to fill out your category.",colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})]})]})}),(0,t.jsx)(K.Z,{title:"Assign Tutors",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,t.jsx)(v.A.Group,{size:24,children:(0,t.jsx)(h.u,{name:"tutors",min:1,copyIconProps:{tooltipText:"Copy this tutor"},deleteIconProps:{tooltipText:"Delete this tutor"},creatorButtonProps:{creatorButtonText:"Add New Tutor"},children:(0,t.jsx)(v.A.Group,{size:24,children:(0,t.jsx)(c.Z,{name:"tutor",label:"Tutor",showSearch:!0,options:Pe,debounceTime:300,placeholder:"Please Select a Tutor",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})})}),(0,t.jsx)(K.Z,{title:"Assign Users",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,t.jsx)(v.A.Group,{size:24,children:(0,t.jsx)(h.u,{name:"users",min:1,copyIconProps:{tooltipText:"Copy this user"},deleteIconProps:{tooltipText:"Delete this user"},creatorButtonProps:{creatorButtonText:"Add New User"},children:(0,t.jsx)(v.A.Group,{size:24,children:(0,t.jsx)(c.Z,{name:"user",label:"User",showSearch:!0,options:De,debounceTime:300,placeholder:"Please Select a User",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})})})]})]})};O.default=he}}]);
