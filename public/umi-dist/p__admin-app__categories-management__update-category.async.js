"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[186],{51042:function(X,j,e){var _=e(1413),p=e(67294),T=e(42110),i=e(91146),d=function(u,D){return p.createElement(i.Z,(0,_.Z)((0,_.Z)({},u),{},{ref:D,icon:T.Z}))},n=p.forwardRef(d);j.Z=n},38345:function(X,j,e){var _=e(1413),p=e(53911),T=e(44962),i=e(13286),d=e(85893),n=function(D){return(0,d.jsx)(p.Z,(0,_.Z)({bodyStyle:{padding:0}},D))},v=p.Z;v.isProCard=!0,v.Divider=T.Z,v.TabPane=i.Z,v.Group=n,j.Z=v},64317:function(X,j,e){var _=e(1413),p=e(91),T=e(22270),i=e(67294),d=e(66758),n=e(68256),v=e(85893),u=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],D=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],O=function(c,I){var S=c.fieldProps,B=c.children,C=c.params,U=c.proFieldProps,F=c.mode,G=c.valueEnum,$=c.request,z=c.showSearch,M=c.options,f=(0,p.Z)(c,u),oe=(0,i.useContext)(d.Z);return(0,v.jsx)(n.Z,(0,_.Z)((0,_.Z)({valueEnum:(0,T.h)(G),request:$,params:C,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,_.Z)({options:M,mode:F,showSearch:z,getPopupContainer:oe.getPopupContainer},S),ref:I,proFieldProps:U},f),{},{children:B}))},ee=i.forwardRef(function(h,c){var I=h.fieldProps,S=h.children,B=h.params,C=h.proFieldProps,U=h.mode,F=h.valueEnum,G=h.request,$=h.options,z=(0,p.Z)(h,D),M=(0,_.Z)({options:$,mode:U||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},I),f=(0,i.useContext)(d.Z);return(0,v.jsx)(n.Z,(0,_.Z)((0,_.Z)({valueEnum:(0,T.h)(F),request:G,params:B,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,_.Z)({getPopupContainer:f.getPopupContainer},M),ref:c,proFieldProps:C},z),{},{children:S}))}),K=i.forwardRef(O),re=ee,b=K;b.SearchSelect=re,b.displayName="ProFormComponent",j.Z=b},58547:function(X,j,e){e.d(j,{h:function(){return p}});var _=e(67294),p=function(d){return Array.isArray(d)?d:d&&d.fileList},T=function(d){return new Promise(function(n,v){var u=new FileReader;u.readAsDataURL(d.file.originFileObj),u.onload=function(){var D=u.result;n(D)},u.onerror=function(D){return v(D)}})}},11817:function(X,j,e){e.r(j);var _=e(97857),p=e.n(_),T=e(5574),i=e.n(T),d=e(15009),n=e.n(d),v=e(99289),u=e.n(v),D=e(6110),O=e(34994),ee=e(2236),K=e(38345),re=e(5966),b=e(90672),h=e(5155),c=e(64317),I=e(2453),S=e(8232),B=e(71230),C=e(15746),U=e(83622),F=e(95715),G=e(66476),$=e(51042),z=e(88484),M=e(67294),f=e(76772),oe=e(58547),o=e(85893),_e=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return new Promise(function(a){setTimeout(function(){a(!0)},R)})},de={image_url:"",title:"",description:"",tutors:"",users:""},me=function(){var te=u()(n()().mark(function R(a,Y){var V,H,N;return n()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return console.log("onFinishHandlerForm"),console.log("Received values of form: ",a),m.prev=2,N={image_url:Y,title:a==null?void 0:a.title,description:a==null?void 0:a.description,author_id:1,tutors:(a==null||(V=a.tutors)===null||V===void 0?void 0:V.map(function(E){return E==null?void 0:E.tutor}))||[],users:(a==null||(H=a.users)===null||H===void 0?void 0:H.map(function(E){return E==null?void 0:E.user}))||[]},m.next=6,(0,f.request)("/api/categories/"+(a==null?void 0:a.category_id),{method:"PUT",data:N}).then(function(){var E=u()(n()().mark(function w(P){var x,J;return n()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:(P==null||(x=P.data)===null||x===void 0?void 0:x.id)>0&&(I.ZP.success("Submitted successfully"),f.history.push("/admin-app/categories/edit/"+(P==null||(J=P.data)===null||J===void 0?void 0:J.id)));case 1:case"end":return Q.stop()}},w)}));return function(w){return E.apply(this,arguments)}}()).catch(function(E){console.log(E)});case 6:return m.abrupt("return",m.sent);case 9:m.prev=9,m.t0=m.catch(2),console.log("api_response - error"),console.log(m.t0);case 13:return m.abrupt("return",!0);case 14:case"end":return m.stop()}},R,null,[[2,9]])}));return function(a,Y){return te.apply(this,arguments)}}(),pe=function(){var R=(0,f.useParams)(),a=S.Z.useForm(),Y=i()(a,1),V=Y[0],H=(0,M.useState)(0),N=i()(H,2),ne=N[0],m=N[1],E=(0,M.useState)("http://mairaj.project.localhost.com/images/default/placeholder.jpg"),w=i()(E,2),P=w[0],x=w[1],J=(0,M.useState)([]),ae=i()(J,2),Q=ae[0],ve=ae[1],he=(0,M.useState)([]),ce=i()(he,2),Ee=ce[0],Pe=ce[1];return(0,M.useEffect)(function(){m(R.id)},[]),(0,M.useEffect)(function(){return(0,f.request)("/api/users",{params:{role:"tutor",page:1,per_page:1e3}}).then(function(g){var r=g.data.data.map(function(t,W){return{value:t==null?void 0:t.id,label:t==null?void 0:t.name}});return ve(r),r})},[]),(0,M.useEffect)(function(){return(0,f.request)("/api/users",{params:{role:"user",page:1,per_page:1e3}}).then(function(g){var r=g.data.data.map(function(t,W){return{value:t==null?void 0:t.id,label:t==null?void 0:t.name}});return Pe(r),r})},[]),(0,o.jsxs)(D._z,{children:[(0,o.jsxs)(B.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,o.jsx)(C.Z,{flex:"auto"}),(0,o.jsx)(C.Z,{flex:"100px",children:(0,o.jsxs)(U.ZP,{type:"primary",onClick:function(){f.history.push("/admin-app/categories/new")},style:{marginBlockEnd:15},children:[(0,o.jsx)($.Z,{})," New"]},"new")})]}),(0,o.jsxs)(O.A,{layout:"vertical",grid:!0,initialValues:de,form:V,params:{category_id:ne},request:u()(n()().mark(function g(){var r,t=arguments;return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(r=t.length>0&&t[0]!==void 0?t[0]:{},console.log("proform-params"),console.log(r),(r==null?void 0:r.category_id)!=0){l.next=5;break}return l.abrupt("return");case 5:return l.next=7,_e(2e3);case 7:return l.next=9,(0,f.request)("/api/categories/"+(r==null?void 0:r.category_id),{method:"GET"}).then(function(){var k=u()(n()().mark(function y(s){var se,le,ie,ue,L,Z;return n()().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return console.log("api_response"),console.log(s),x(s==null||(se=s.data)===null||se===void 0?void 0:se.image_url),q.abrupt("return",p()(p()({},de),{},{image_url:s==null||(le=s.data)===null||le===void 0?void 0:le.image_url,title:s==null||(ie=s.data)===null||ie===void 0?void 0:ie.title,description:s==null||(ue=s.data)===null||ue===void 0?void 0:ue.description,tutors:(s==null||(L=s.data)===null||L===void 0||(L=L.tutors)===null||L===void 0?void 0:L.map(function(A){return{tutor:A==null?void 0:A.id}}))||[],users:(s==null||(Z=s.data)===null||Z===void 0||(Z=Z.users)===null||Z===void 0?void 0:Z.map(function(A){return{user:A==null?void 0:A.id}}))||[]}));case 4:case"end":return q.stop()}},y)}));return function(y){return k.apply(this,arguments)}}()).catch(function(k){console.log(k)});case 9:return l.abrupt("return",l.sent);case 10:case"end":return l.stop()}},g)})),onFinish:function(){var g=u()(n()().mark(function r(t){return n()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,_e(2e3);case 2:return t.category_id=ne,t.image_url=P,l.next=6,me(t,P);case 6:case"end":return l.stop()}},r)}));return function(r){return g.apply(this,arguments)}}(),submitter:{render:function(r,t){return(0,o.jsx)(ee.S,{children:t})}},children:[(0,o.jsx)(K.Z,{title:"Category Details",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},onCollapse:function(r){return console.log(r)},children:(0,o.jsxs)(B.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,o.jsx)(C.Z,{span:6,children:(0,o.jsxs)(O.A.Group,{size:24,children:[(0,o.jsx)(C.Z,{span:24,children:(0,o.jsx)(F.Z,{width:"100%",height:200,src:P,fallback:P!==""||P===null?P:"http://mairaj.project.localhost.com/images/default/placeholder.jpg"})}),(0,o.jsx)(C.Z,{span:24,style:{textAlign:"center"},children:(0,o.jsx)(O.A.Item,{name:"image_url",getValueFromEvent:oe.h,children:(0,o.jsx)(G.Z,{name:"file",onChange:function(r){if(console.log("file - onChange - info"),console.log(r),r.file.status!=="uploading"){if(r.file.status=="removed"&&x(""),r.file.status==="done"){var t;x(r==null||(t=r.file)===null||t===void 0||(t=t.response)===null||t===void 0?void 0:t.url)}r.file.status==="error"&&I.ZP.error("".concat(r.file.name," file upload failed."))}},maxCount:1,action:"/api/file-manager/upload",data:{directory:"categories"},onRemove:function(r){console.log("file is removed"),console.log(r),(0,f.request)("/api/file-manager/delete",{method:"DELETE",data:{filename:r==null?void 0:r.name,directory:"categories"}}).then(function(){var t=u()(n()().mark(function W(l){return n()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:console.log("api_response"),console.log(l);case 2:case"end":return y.stop()}},W)}));return function(W){return t.apply(this,arguments)}}())},children:(0,o.jsx)(U.ZP,{type:"primary",icon:(0,o.jsx)(z.Z,{}),style:{margin:"10px 0px 0px 0px"},onClick:function(r){},children:"Change Image"})})})})]})}),(0,o.jsxs)(C.Z,{span:18,children:[(0,o.jsx)(O.A.Group,{size:24,children:(0,o.jsx)(re.Z,{name:"title",label:"Title",placeholder:"Type Category Title",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,o.jsx)(O.A.Group,{size:24,children:(0,o.jsx)(b.Z,{name:"description",label:"Description",fieldProps:{rows:6},placeholder:"Share a little description to fill out your category.",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})]})]})}),(0,o.jsx)(K.Z,{title:"Assign Tutors",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,o.jsx)(O.A.Group,{size:24,children:(0,o.jsx)(h.u,{name:"tutors",min:1,copyIconProps:{tooltipText:"Copy this tutor"},deleteIconProps:{tooltipText:"Delete this tutor"},creatorButtonProps:{creatorButtonText:"Add New Tutor"},children:(0,o.jsx)(O.A.Group,{size:24,children:(0,o.jsx)(c.Z,{name:"tutor",label:"Tutor",showSearch:!0,options:Q,debounceTime:300,placeholder:"Please Select a Tutor",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})})}),(0,o.jsx)(K.Z,{title:"Assign Users",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,o.jsx)(O.A.Group,{size:24,children:(0,o.jsx)(h.u,{name:"users",min:1,copyIconProps:{tooltipText:"Copy this user"},deleteIconProps:{tooltipText:"Delete this user"},creatorButtonProps:{creatorButtonText:"Add New User"},children:(0,o.jsx)(O.A.Group,{size:24,children:(0,o.jsx)(c.Z,{name:"user",label:"User",showSearch:!0,options:Ee,debounceTime:300,placeholder:"Please Select a User",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})})})]})]})};j.default=pe}}]);
