"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[472],{62414:function(Ee,re,n){n.r(re),n.d(re,{default:function(){return Be}});var ce=n(97857),ne=n.n(ce),he=n(5574),Q=n.n(he),ve=n(15009),s=n.n(ve),me=n(99289),z=n.n(me),pe=n(6110),T=n(34994),fe=n(2236),O=n(38345),Y=n(5966),ge=n(90672),xe=n(21134),W=n(64317),k=n(5155),q=n(2453),R=n(47019),ye=n(71230),ie=n(15746),N=n(83622),se=n(51042),I=n(67294),$=n(76772),je=n(91319),Se=n(47389),Ce=n(27484),ae=n.n(Ce),oe=n(37476),qe=n(15623),e=n(85893),ze=function(d){var r=d.visible,j=d.onVisiblityChange,c=d.onFinish,E=d.quizID,P=d.authorID,p=R.Z.useForm(),S=Q()(p,1),D=S[0],C=(0,I.useState)([]),V=Q()(C,2),B=V[0],Z=V[1],f={choices:[{choice:void 0}]};return(0,e.jsx)(oe.Y,{form:D,open:r,onOpenChange:function(h){h||j(h)},modalProps:{destroyOnClose:!0,getContainer:function(){document.body},width:1200,okText:"Create"},submitter:{resetButtonProps:{style:{}},submitButtonProps:{style:{}}},grid:!0,initialValues:f,onFieldsChange:function(){var a=z()(s()().mark(function h(u,o){var t;return s()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:console.log("changedFieldName = ",u[0].name),u&&u[0].name.includes("choices")&&(t=D.getFieldValue("choices"),console.log("choices",t),Z(t));case 2:case"end":return l.stop()}},h)}));return function(h,u){return a.apply(this,arguments)}}(),preserve:!1,submitTimeout:2e3,onFinish:function(){var a=z()(s()().mark(function h(u){var o;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o={quiz_id:E,author_id:P,title:u==null?void 0:u.title,choices:u==null?void 0:u.choices,answer:u==null?void 0:u.answer},(0,$.request)("/api/questions",{method:"POST",data:o}).then(function(){var l=z()(s()().mark(function g(A){var v;return s()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:(A==null||(v=A.data)===null||v===void 0?void 0:v.id)>0?(c({status:!0,text_message:"Question created successfully"}),j(!1)):c({status:!1,text_message:"Failed to create Question: Invalid response"});case 1:case"end":return w.stop()}},g)}));return function(g){return l.apply(this,arguments)}}()).catch(function(l){console.log(l)}),i.abrupt("return",!0);case 3:case"end":return i.stop()}},h)}));return function(h){return a.apply(this,arguments)}}(),children:(0,e.jsxs)(O.Z,{title:"Create Question",bordered:!0,headerBordered:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:[(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(Y.Z,{name:"title",label:"Title",placeholder:"Type Question Title",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(k.u,{name:"choices",min:1,max:4,copyIconProps:{tooltipText:"Copy this choice"},deleteIconProps:{tooltipText:"Delete this choice"},creatorButtonProps:{creatorButtonText:"Add New Choice"},children:(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(Y.Z,{name:"choice",label:"Choice",placeholder:"Type Your Choice",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})}),(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(W.Z,{name:"answer",label:"Answer",showSearch:!0,params:{selected_choices:B},request:function(){var a=z()(s()().mark(function h(u){var o;return s()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return o=u==null?void 0:u.selected_choices.map(function(l,g){return{label:l==null?void 0:l.choice,value:(l==null?void 0:l.choice).trim().replace(/\s+/g,"-").toLowerCase()}}),console.log("options",o),i.abrupt("return",o);case 3:case"end":return i.stop()}},h)}));return function(h){return a.apply(this,arguments)}}(),debounceTime:300,placeholder:"Please Select a Answer",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})]})})},Pe=ze,we=function(d){var r=d.visible,j=d.onVisiblityChange,c=d.editModelData,E=d.onFinish,P=R.Z.useForm(),p=Q()(P,1),S=p[0],D=(0,I.useState)([]),C=Q()(D,2),V=C[0],B=C[1];return(0,e.jsx)(oe.Y,{open:r,onOpenChange:function(f){f||j(f)},modalProps:{destroyOnClose:!0,getContainer:function(){document.body},width:1200,okText:"Update"},submitter:{resetButtonProps:{style:{}},submitButtonProps:{style:{}}},grid:!0,onFieldsChange:function(){var Z=z()(s()().mark(function f(a,h){var u;return s()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("changedFieldName = ",a[0].name),a&&a[0].name.includes("choices")&&(u=S.getFieldValue("choices"),console.log("choices",u),B(u));case 2:case"end":return t.stop()}},f)}));return function(f,a){return Z.apply(this,arguments)}}(),preserve:!1,submitTimeout:2e3,onFinish:function(){var Z=z()(s()().mark(function f(a){var h;return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return h={quiz_id:quizID,author_id:authorID,title:a==null?void 0:a.title,choices:a==null?void 0:a.choices,answer:a==null?void 0:a.answer},(0,$.request)("/api/questions/"+(c==null?void 0:c.id),{method:"PUT",data:h}).then(function(){var t=z()(s()().mark(function i(l){var g;return s()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:(l==null||(g=l.data)===null||g===void 0?void 0:g.id)>0?(E({status:!0,text_message:"Question updated successfully"}),j(!1)):E({status:!1,text_message:"Failed to update Question: Invalid response"});case 1:case"end":return v.stop()}},i)}));return function(i){return t.apply(this,arguments)}}()).catch(function(t){console.log(t)}),o.abrupt("return",!0);case 3:case"end":return o.stop()}},f)}));return function(f){return Z.apply(this,arguments)}}(),children:(0,e.jsxs)(O.Z,{title:"Edit Question",bordered:!0,headerBordered:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:[(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(Y.Z,{name:"title",label:"Title",initialValue:c==null?void 0:c.title,placeholder:"Type Question Title",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(k.u,{name:"choices",min:1,max:4,initialValue:c==null?void 0:c.choices,copyIconProps:{tooltipText:"Copy this choice"},deleteIconProps:{tooltipText:"Delete this choice"},creatorButtonProps:{creatorButtonText:"Add New Choice"},children:(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(Y.Z,{name:"choice",label:"Choice",placeholder:"Type Your Choice",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})}),(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(W.Z,{name:"answer",label:"Answer",initialValue:c==null?void 0:c.answer,showSearch:!0,params:{selected_choices:V},request:function(){var Z=z()(s()().mark(function f(a){var h;return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return h=a==null?void 0:a.selected_choices.map(function(t,i){return{label:t==null?void 0:t.choice,value:(t==null?void 0:t.choice).trim().replace(/\s+/g,"-").toLowerCase()}}),console.log("options",h),o.abrupt("return",h);case 3:case"end":return o.stop()}},f)}));return function(f){return Z.apply(this,arguments)}}(),debounceTime:300,placeholder:"Please Select a Answer",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})]})})},Fe=we,be=n(86738),Te=n(63783),Ie=n(82061),Ze=function(d){var r=d.rowId,j=d.onFinish;return(0,e.jsx)(be.Z,{title:"Delete the Question",description:"Are you sure you want to delete this Question?",icon:(0,e.jsx)(Te.Z,{style:{color:"red"}}),placement:"left",onConfirm:z()(s()().mark(function c(){return s()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,$.request)("/api/questions/"+r,{method:"DELETE"}).then(function(p){p.status===!0?j({status:!0,text_message:"Question deleted successfully"}):j({status:!1,text_message:"Failed to delete Question: Invalid response"})});case 2:return P.abrupt("return",P.sent);case 3:case"end":return P.stop()}},c)})),okText:"Yes",cancelText:"No",children:(0,e.jsx)(N.ZP,{danger:!0,children:(0,e.jsx)(Ie.Z,{})},"deletable")})},De=Ze,Ae=function(d){var r=d.questionsTableRef,j=d.quizID,c=d.authorID,E=(0,I.useState)(!1),P=Q()(E,2),p=P[0],S=P[1],D=(0,I.useState)(!1),C=Q()(D,2),V=C[0],B=C[1],Z=(0,I.useState)({}),f=Q()(Z,2),a=f[0],h=f[1],u=[{title:"ID",dataIndex:"id",key:"table-column-id",hideInSearch:!0,sorter:!0,defaultSortOrder:"descend"},{title:"Title",dataIndex:"title",key:"table-column-title",hideInSearch:!0},{title:"Created Date",dataIndex:"created_at",key:"table-column-created-date",sorter:!0,hideInForm:!0,hideInSearch:!0,render:function(t){return(0,e.jsx)("p",{children:ae()(new Date(t)).format("DD-MM-YYYY")})}},{title:"Updated Date",dataIndex:"updated_at",key:"table-column-updated-date",sorter:!0,hideInForm:!0,hideInSearch:!0,render:function(t){return(0,e.jsx)("p",{children:ae()(new Date(t)).format("DD-MM-YYYY")})}},{title:"Actions",valueType:"option",key:"table-column-actions",render:function(t,i,l,g){return[(0,e.jsx)(N.ZP,{onClick:function(){h(i),B(!0)},children:(0,e.jsx)(Se.Z,{})},"editable"),(0,e.jsx)(De,{rowId:i==null?void 0:i.id,onFinish:function(v){var M=v.status,w=v.text_message;if(M){var x;q.ZP.success(w),(x=r.current)===null||x===void 0||x.reload()}else q.ZP.error(w)}})]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(O.Z,{title:"Question Details",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,e.jsx)(je.Z,{actionRef:r,rowKey:"id",search:!1,options:!1,pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:[10,20,50,100]},toolBarRender:function(){return[(0,e.jsxs)(N.ZP,{type:"primary",onClick:function(){S(!0)},children:[(0,e.jsx)(se.Z,{})," New"]},"new")]},request:z()(s()().mark(function o(){var t,i,l,g,A,v=arguments;return s()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return t=v.length>0&&v[0]!==void 0?v[0]:{},i=v.length>1?v[1]:void 0,l=v.length>2?v[2]:void 0,g=v.length>3?v[3]:void 0,w.next=6,(0,$.request)("/api/questions",{params:{page:t==null?void 0:t.current,per_page:t==null?void 0:t.pageSize,order_by:"id",order:"desc"}}).catch(function(x){console.log(x)});case 6:return A=w.sent,w.abrupt("return",{data:A.data.data,total:A.data.total,current_page:A.data.current_page});case 8:case"end":return w.stop()}},o)})),columns:u})}),(0,e.jsx)(Pe,{visible:p,onVisiblityChange:function(t){var i=t.VisiblityStatus;S(i)},onFinish:function(t){var i=t.status,l=t.text_message;if(i){var g;q.ZP.success(l),(g=r.current)===null||g===void 0||g.reload()}else q.ZP.error(l)},quizID:j,authorID:c}),(0,e.jsx)(Fe,{visible:V,onVisiblityChange:function(t){var i=t.VisiblityStatus;B(i)},editModelData:a,onFinish:function(t){var i=t.status,l=t.text_message;if(i){var g;q.ZP.success(l),(g=r.current)===null||g===void 0||g.reload()}else q.ZP.error(l)}})]})},Qe=Ae,le=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return new Promise(function(r){setTimeout(function(){r(!0)},d)})},ue={title:"",description:"",status:"",class_id:"",users:""},$e=function(){var G=z()(s()().mark(function d(r,j){var c,E;return s()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return console.log("onFinishHandlerForm"),console.log("Received values of form: ",r),p.prev=2,E={title:r==null?void 0:r.title,description:r==null?void 0:r.description,status:r==null?void 0:r.status,author_id:j,class_id:r==null?void 0:r.class_id,users:(r==null||(c=r.users)===null||c===void 0?void 0:c.map(function(S){return S==null?void 0:S.user}))||[]},p.next=6,(0,$.request)("/api/quizzes/"+(r==null?void 0:r.quiz_id),{method:"PUT",data:E}).then(function(){var S=z()(s()().mark(function D(C){var V,B;return s()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:(C==null||(V=C.data)===null||V===void 0?void 0:V.id)>0&&(q.ZP.success("Submitted successfully"),$.history.push("/admin-app/quizzes/edit/"+(C==null||(B=C.data)===null||B===void 0?void 0:B.id)));case 1:case"end":return f.stop()}},D)}));return function(D){return S.apply(this,arguments)}}()).catch(function(S){console.log(S)});case 6:return p.abrupt("return",p.sent);case 9:p.prev=9,p.t0=p.catch(2),console.log("api_response - error"),console.log(p.t0);case 13:return p.abrupt("return",!0);case 14:case"end":return p.stop()}},d,null,[[2,9]])}));return function(r,j){return G.apply(this,arguments)}}(),Ve=function(){var d=(0,$.useParams)(),r=(0,$.useModel)("@@initialState"),j=r.initialState,c=r.loading,E=r.refresh,P=r.setInitialState,p=(0,I.useState)(0),S=Q()(p,2),D=S[0],C=S[1],V=R.Z.useForm(),B=Q()(V,1),Z=B[0],f=(0,I.useRef)(),a=(0,I.useState)([]),h=Q()(a,2),u=h[0],o=h[1],t=(0,I.useState)([]),i=Q()(t,2),l=i[0],g=i[1],A=(0,I.useState)(0),v=Q()(A,2),M=v[0],w=v[1];return(0,I.useEffect)(function(){var x;C(j==null||(x=j.currentUser)===null||x===void 0?void 0:x.id)},[]),(0,I.useEffect)(function(){w(d.id)},[]),(0,I.useEffect)(function(){return(0,$.request)("/api/classes",{}).then(function(x){var y=x.data.data.map(function(m,H){return{value:m==null?void 0:m.id,label:m==null?void 0:m.title}});return o(y),y})},[]),(0,I.useEffect)(function(){return(0,$.request)("/api/users",{params:{role:"user",page:1,per_page:1e3}}).then(function(x){var y=x.data.data.map(function(m,H){return{value:m==null?void 0:m.id,label:m==null?void 0:m.name}});return g(y),y})},[]),(0,e.jsxs)(pe._z,{children:[(0,e.jsxs)(ye.Z,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,e.jsx)(ie.Z,{flex:"auto"}),(0,e.jsx)(ie.Z,{flex:"100px",children:(0,e.jsxs)(N.ZP,{type:"primary",onClick:function(){$.history.push("/admin-app/quizzes/new")},style:{marginBlockEnd:15},children:[(0,e.jsx)(se.Z,{})," New"]},"new")})]}),(0,e.jsxs)(T.A,{layout:"vertical",grid:!0,initialValues:ue,form:Z,params:{quiz_id:M},request:z()(s()().mark(function x(){var y,m=arguments;return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(y=m.length>0&&m[0]!==void 0?m[0]:{},(y==null?void 0:y.quiz_id)!=0){F.next=3;break}return F.abrupt("return");case 3:return F.next=5,le(2e3);case 5:return F.next=7,(0,$.request)("/api/quizzes/"+(y==null?void 0:y.quiz_id),{method:"GET"}).then(function(){var K=z()(s()().mark(function de(b){var J,X,_,ee,U;return s()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.abrupt("return",ne()(ne()({},ue),{},{title:b==null||(J=b.data)===null||J===void 0?void 0:J.title,description:b==null||(X=b.data)===null||X===void 0?void 0:X.description,status:b==null||(_=b.data)===null||_===void 0?void 0:_.status,class_id:b==null||(ee=b.data)===null||ee===void 0?void 0:ee.class_id,users:(b==null||(U=b.data)===null||U===void 0||(U=U.users)===null||U===void 0?void 0:U.map(function(te){return{user:te==null?void 0:te.id}}))||[]}));case 1:case"end":return L.stop()}},de)}));return function(de){return K.apply(this,arguments)}}()).catch(function(K){console.log(K)});case 7:return F.abrupt("return",F.sent);case 8:case"end":return F.stop()}},x)})),onFinish:function(){var x=z()(s()().mark(function y(m){return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,le(2e3);case 2:return m.quiz_id=M,m.author_id=D,F.next=6,$e(m,D);case 6:case"end":return F.stop()}},y)}));return function(y){return x.apply(this,arguments)}}(),submitter:{render:function(y,m){return(0,e.jsx)(fe.S,{children:m})}},children:[(0,e.jsxs)(O.Z,{title:"Quiz Details",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},onCollapse:function(y){return console.log(y)},children:[(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(Y.Z,{name:"title",label:"Title",placeholder:"Type Quiz Title",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(ge.Z,{name:"description",label:"Description",fieldProps:{rows:6},placeholder:"Share a little description to fill out your quiz.",colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})}),(0,e.jsxs)(T.A.Group,{size:24,children:[(0,e.jsx)(xe.Z,{name:"status",label:"Status",initialValue:"in-active",valueEnum:{"in-active":"In-Active",active:"Active"},colProps:{xs:24,sm:24,md:6,lg:6,xl:6}}),(0,e.jsx)(W.Z,{name:"class_id",label:"Classes",showSearch:!0,options:u,debounceTime:300,placeholder:"Please Select a Class",rules:[{required:!0}],colProps:{xs:24,sm:24,md:18,lg:18,xl:18}})]})]}),(0,e.jsx)(O.Z,{title:"Assign Users",bordered:!0,headerBordered:!0,collapsible:!0,size:"default",type:"inner",style:{marginBlockEnd:15,minWidth:800,maxWidth:"100%"},children:(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(k.u,{name:"users",min:1,copyIconProps:{tooltipText:"Copy this user"},deleteIconProps:{tooltipText:"Delete this user"},creatorButtonProps:{creatorButtonText:"Add New User"},children:(0,e.jsx)(T.A.Group,{size:24,children:(0,e.jsx)(W.Z,{name:"user",label:"User",showSearch:!0,options:l,debounceTime:300,placeholder:"Please Select a User",rules:[{required:!0}],colProps:{xs:24,sm:24,md:24,lg:24,xl:24}})})})})}),(0,e.jsx)(Qe,{questionsTableRef:f,quizID:M,authorID:D}),","]})]})},Be=Ve}}]);
